<!DOCTYPE html>
<html>
  <head>
    <title>Södra Skånes distriktsstämma</title>
    <link rel="stylesheet" href="/static/css/style.css" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
var logged_in = {% if logged_in %}true{% else %}false{% endif %};
var updateList = function() {
  $.get({
    url: "/api/speakers",
    headers: {
      "Accept": "application/json"
    },
    success: function(result) {
      html = '';
      for (row in result) {
        html += '<tr><td class="id_column">' + result[row].delegate.delegate +
            '</td><td class="name_column">' + result[row].delegate.name +
            '</td><td class="group_column">' + result[row].delegate.group +
            '</td><td class="control_column">';
        if (logged_in) {
          html += '<a href="/edit/' + result[row].delegate.delegate +
              '">Ändra</a> | <a href="javascript:removeSpeaker(' +
              result[row].speaker + ')">Ta bort</a>';
        }
        html += '</td></tr>';
      }
      $('#list > tbody').html(html);
    }
  });
  setTimeout(updateList, 1000);
};

var removeSpeaker = function(speaker) {
  $.ajax({
    method: "delete",
    url: "/api/speakers/" + speaker
  });
};

$(function() {
  updateList();
});
    </script>
  </head>
  <body>
    <h1>Talarlista</h1>
    <table id="list">
      <thead>
        <tr>
          <th class="id_column">Delegat</th>
          <th class="name_column">Namn</th>
          <th class="group_column">Scoutkår</th>
          <th class="control_column">&nbsp;</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </body>
</html>
